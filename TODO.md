1. fixing memory overflow errors and handling length parameter of the mrstr_p
