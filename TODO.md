1. fixing memory overflow errors and handling length parameter of the mrstr_p
2. fixing case checks in operation functions
