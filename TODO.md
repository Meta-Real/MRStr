1. fixing memory overflow errors and handling length parameter of the mrstr_p
2. cleaning up code and
3. fixing print function
